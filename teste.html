<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Editar Eventos com Cards</title>
  <link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.css' rel='stylesheet' />
  <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js'></script>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    #calendar {
      max-width: 900px;
      margin: 40px auto;
    }
    #eventCards {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .card {
      border: 1px solid #ccc;
      padding: 10px;
      margin: 5px;
      width: 200px;
    }
    #editForm {
      display: none;
      margin: 20px;
    }
    input, button {
      margin: 5px;
    }
  </style>
</head>
<body>

  <h1 style="text-align: center;">Calendário de Eventos com Edição por Card</h1>
  
  <!-- Área para os cards -->
  <div id="eventCards"></div>

  <!-- Formulário de Edição -->
  <div id="editForm">
    <h3>Editar Evento</h3>
    <input type="text" id="editTitle" placeholder="Novo Título" />
    <input type="date" id="editDate" />
    <button onclick="updateEvent()">Atualizar Evento</button>
    <button onclick="cancelEdit()">Cancelar</button>
  </div>

  <!-- Calendário -->
  <div id="calendar"></div>

  <script>
    let selectedEvent = null;  // Variável para armazenar o evento selecionado para edição
    let calendar;

    document.addEventListener('DOMContentLoaded', function() {
      var calendarEl = document.getElementById('calendar');

      calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        editable: true,
        selectable: true,
        events: [
          { title: 'Evento 1', start: '2024-09-15', allDay: true },
          { title: 'Evento 2', start: '2024-09-16', allDay: true }
        ]
      });

      calendar.render();

      // Função para gerar os cards de eventos
      generateEventCards();

    });

    // Função para gerar os cards dos eventos
    function generateEventCards() {
      const eventCards = document.getElementById('eventCards');
      eventCards.innerHTML = '';  // Limpa os cards anteriores
      const events = calendar.getEvents();

      events.forEach(event => {
        const card = document.createElement('div');
        card.classList.add('card');
        card.innerHTML = `
          <h4>${event.title}</h4>
          <p>Data: ${event.start.toISOString().split('T')[0]}</p>
          <button onclick="editEvent('${event.id}')">Editar</button>
        `;
        eventCards.appendChild(card);
      });
    }

    // Função para abrir o formulário de edição e carregar o evento
    function editEvent(eventId) {
      const event = calendar.getEventById(eventId);  // Pega o evento pelo ID
      selectedEvent = event;

      // Preenche o formulário de edição com os dados do evento
      document.getElementById('editTitle').value = event.title;
      document.getElementById('editDate').value = event.start.toISOString().split('T')[0];

      // Exibe o formulário de edição
      document.getElementById('editForm').style.display = 'block';
    }

    // Função para atualizar o evento
    function updateEvent() {
      const newTitle = document.getElementById('editTitle').value;
      const newDate = document.getElementById('editDate').value;

      if (newTitle && newDate) {
        // Atualiza as propriedades do evento
        selectedEvent.setProp('title', newTitle);
        selectedEvent.setStart(newDate);

        // Esconde o formulário de edição
        document.getElementById('editForm').style.display = 'none';

        // Atualiza os cards com os novos dados
        generateEventCards();
      } else {
        alert('Por favor, insira o novo título e a nova data.');
      }
    }

    // Função para cancelar a edição
    function cancelEdit() {
      document.getElementById('editForm').style.display = 'none';
    }

  </script>

</body>
</html>
